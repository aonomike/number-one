$(function(){"use strict";var a=Backbone.Model.extend({defaults:{artist:"",title:"",videoId:""}}),b=Backbone.Collection.extend({model:a,url:"https://number-oneapp.herokuapp.com/api/records"}),c=new b,d=Backbone.View.extend({el:"#main",events:{"submit #dateEntry":"submit"},initialize:function(){this.$record=this.$("#record")},render:function(a){var b=new e({model:a});return this.$record.html(b.render().el),this},submit:function(b){b.preventDefault();var d=$("#dateEntry").serializeArray()[0].value,e=new a({id:d},{collection:c}),f=this;e.fetch({success:function(a,b,c){f.render(a)}})}}),e=Backbone.View.extend({tagName:"h2",template:_.template("<%= artist %>: <%= title %>"),initialize:function(){this.model.on("sync",this.render,this)},render:function(){var a=this.model.toJSON();return this.$el.html(this.template(a)),this.getVideoId(),this},getVideoId:function(){var a=this,b=a.model.get("artist")+"+"+a.model.get("title");$.ajax({url:"https://www.googleapis.com/youtube/v3/search",data:{part:"snippet",type:"video",videoEmbeddable:"true",maxResults:"1",key:"AIzaSyA5UichqO_WSK22RMjGqWhmz-GvRQK9Szg",q:b},type:"GET",success:function(b){a.model.set("videoId",b.items[0].id.videoId),console.log(a.model.toJSON()),a.loadVideo()}})},loadVideo:function(){function a(a){}var b,c=this,d=document.createElement("script");d.src="https://www.youtube.com/iframe_api";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(d,e),window.onYouTubeIframeAPIReady=function(){b=new YT.Player("player",{height:"390",width:"640",videoId:c.model.get("videoId"),events:{onReady:a}})}}});new d}),$(function(){$("#date").combodate({minYear:1952,format:"YYYY-MM-DD"})});